{"version":3,"file":"VConfirmEdit.js","names":["VBtn","useLocale","useProxiedModel","computed","ref","toRaw","watchEffect","deepEqual","genericComponent","propsFactory","useRender","makeVConfirmEditProps","modelValue","color","String","cancelText","type","default","okText","disabled","Boolean","Array","undefined","hideActions","VConfirmEdit","name","props","emits","cancel","save","value","setup","_ref","emit","slots","model","internalModel","structuredClone","t","isPristine","isActionDisabled","action","isArray","includes","isSaveDisabled","isCancelDisabled","actions","actionsProps","_createVNode","_Fragment","_mergeProps","actionsUsed"],"sources":["../../../src/components/VConfirmEdit/VConfirmEdit.tsx"],"sourcesContent":["// Components\nimport { VBtn } from '@/components/VBtn'\n\n// Composables\nimport { useLocale } from '@/composables'\nimport { useProxiedModel } from '@/composables/proxiedModel'\n\n// Utilities\nimport { computed, ref, toRaw, watchEffect } from 'vue'\nimport { deepEqual, genericComponent, propsFactory, useRender } from '@/util'\n\n// Types\nimport type { PropType, Ref, VNode } from 'vue'\nimport type { GenericProps } from '@/util'\n\nexport type VConfirmEditSlots<T> = {\n  default: {\n    model: Ref<T>\n    save: () => void\n    cancel: () => void\n    isPristine: boolean\n    get actions (): (props?: {}) => VNode\n  }\n}\n\nexport const makeVConfirmEditProps = propsFactory({\n  modelValue: null,\n  color: String,\n  cancelText: {\n    type: String,\n    default: '$vuetify.confirmEdit.cancel',\n  },\n  okText: {\n    type: String,\n    default: '$vuetify.confirmEdit.ok',\n  },\n  disabled: {\n    type: [Boolean, Array] as PropType<boolean | ('save' | 'cancel')[]>,\n    default: undefined,\n  },\n  hideActions: Boolean,\n}, 'VConfirmEdit')\n\nexport const VConfirmEdit = genericComponent<new <T> (\n  props: {\n    modelValue?: T\n    'onUpdate:modelValue'?: (value: T) => void\n    'onSave'?: (value: T) => void\n  },\n  slots: VConfirmEditSlots<T>\n) => GenericProps<typeof props, typeof slots>>()({\n  name: 'VConfirmEdit',\n\n  props: makeVConfirmEditProps(),\n\n  emits: {\n    cancel: () => true,\n    save: (value: any) => true,\n    'update:modelValue': (value: any) => true,\n  },\n\n  setup (props, { emit, slots }) {\n    const model = useProxiedModel(props, 'modelValue')\n    const internalModel = ref()\n    watchEffect(() => {\n      internalModel.value = structuredClone(toRaw(model.value))\n    })\n\n    const { t } = useLocale()\n\n    const isPristine = computed(() => {\n      return deepEqual(model.value, internalModel.value)\n    })\n\n    function isActionDisabled (action: 'save' | 'cancel') {\n      if (typeof props.disabled === 'boolean') {\n        return props.disabled\n      }\n\n      if (Array.isArray(props.disabled)) {\n        return props.disabled.includes(action)\n      }\n\n      return isPristine.value\n    }\n\n    const isSaveDisabled = computed(() => isActionDisabled('save'))\n    const isCancelDisabled = computed(() => isActionDisabled('cancel'))\n\n    function save () {\n      model.value = internalModel.value\n      emit('save', internalModel.value)\n    }\n\n    function cancel () {\n      internalModel.value = structuredClone(toRaw(model.value))\n      emit('cancel')\n    }\n\n    function actions (actionsProps?: {}) {\n      return (\n        <>\n          <VBtn\n            disabled={ isCancelDisabled.value }\n            variant=\"text\"\n            color={ props.color }\n            onClick={ cancel }\n            text={ t(props.cancelText) }\n            { ...actionsProps }\n          />\n\n          <VBtn\n            disabled={ isSaveDisabled.value }\n            variant=\"text\"\n            color={ props.color }\n            onClick={ save }\n            text={ t(props.okText) }\n            { ...actionsProps }\n          />\n        </>\n      )\n    }\n\n    let actionsUsed = false\n    useRender(() => {\n      return (\n        <>\n          {\n            slots.default?.({\n              model: internalModel,\n              save,\n              cancel,\n              isPristine: isPristine.value,\n              get actions () {\n                actionsUsed = true\n                return actions\n              },\n            })\n          }\n\n          { !props.hideActions && !actionsUsed && actions() }\n        </>\n      )\n    })\n\n    return {\n      save,\n      cancel,\n      isPristine,\n    }\n  },\n})\n\nexport type VConfirmEdit = InstanceType<typeof VConfirmEdit>\n"],"mappings":"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","ignoreList":[]}